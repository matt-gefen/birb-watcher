<%- include('../partials/html-head') %>
<link 
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
  rel="stylesheet" 
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
  crossorigin="anonymous"
>
<link rel="stylesheet" href="/stylesheets/showSighting.css">
<%- include('../partials/search') %>
<%- include('../partials/nav') %>

<main>
  <h1><%= title %>:</h1>
  <h2>Date: <%=sighting.date.toDateString()%></h2>
  <h2>Location: <%= sighting.city %>, <%= sighting.state%> </h2>
  <h3>Notes: <%= sighting.notes %></h3>
  <% if (isSelf) { %>
    <a href="/profiles/<%=profile._id%>/<%=sighting._id%>/edit"><button type="submit">Edit Details</button></a>   
  <% } %>
  <h1>Birds Sighted:</h1>
  <% if (sighting.birds.length) { %>
    <% sighting.birds.forEach(bird => {  %> 
      <div class="card text-center">
        <div id='sighting-header' class="card-header">
            <form action='/profiles/<%=profile._id%>/<%=sighting._id%>/<%=bird._id%>/?_method=DELETE' method='post'>
              <button type="submit">X</button>
            </form>
        </div>
        <div class="card-body">
          <h5 class="card-title"><%= bird.commonName %> </h5>
          <a href="/profiles/<%=profile._id%>/<%=sighting._id%>" class="btn btn-primary">Details</a>
        </div>
        <div class="card-footer text-muted">
        </div>
      </div>
    <% }) %> 
  <% } else { %>
    <h3>No Birds Added</h3>
  <% } %> 

  <form action='/profiles/<%=profile._id%>/<%=sighting._id%>' method='post'>
    <label>
      Add Bird Sighted:
      <select class="js-example-basic-single" name='bird'>
        <% usSpecies.forEach((species) => { %> 
          <option value="<%=species.speciesCode%>"><%=species.comName%></option>
        <% }) %> 
      </select>
    </label><br>
    <button type="submit">Add Birds</button>
  </form>
  <form action='/profiles/<%=profile._id%>/<%=sighting._id%>?_method=DELETE' method='post'>
    <button type="submit">Delete Sighting</button>
  </form>
</main>

<%- include('../partials/footer') %>